{% extends 'base.html' %}
{% load static %}

{% block title %}–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç–æ–∏–º–æ—Å—Ç–∏ ‚Äî YourClean{% endblock %}
{% block meta_description %}–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–±–æ—Ä–∫–∏ –æ–Ω–ª–∞–π–Ω. –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É, —Ç–∏–ø —É—Å–ª—É–≥–∏ –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ü–µ–Ω—É —Å—Ä–∞–∑—É.{% endblock %}

{% block content %}
<!-- Page Hero -->
<section class="page-hero page-hero--calculator">
    <div class="container">
        <div class="page-hero__content">
            <span class="page-hero__badge">–û–Ω–ª–∞–π–Ω –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</span>
            <h1 class="page-hero__title">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å</h1>
            <p class="page-hero__subtitle">
                –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É, —Ç–∏–ø —É—Å–ª—É–≥–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —É–∑–Ω–∞–µ—Ç–µ —Ç–æ—á–Ω—É—é —Ü–µ–Ω—É
            </p>
        </div>
    </div>
</section>

<!-- Calculator Section -->
<section class="calculator-section" id="calculator">
    <div class="container">
        <!-- Steps Indicator -->
        <div class="steps-indicator">
            <div class="step-item active" data-step="1">
                <div class="step-item__number">1</div>
                <div class="step-item__label">–î–∞—Ç–∞</div>
            </div>
            <div class="step-item" data-step="2">
                <div class="step-item__number">2</div>
                <div class="step-item__label">–£—Å–ª—É–≥–∞</div>
            </div>
            <div class="step-item" data-step="3">
                <div class="step-item__number">3</div>
                <div class="step-item__label">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã</div>
            </div>
            <div class="step-item" data-step="4">
                <div class="step-item__number">4</div>
                <div class="step-item__label">–ó–∞–∫–∞–∑</div>
            </div>
        </div>

        <div class="calculator-wrapper">
            <div class="calculator-card animate-fade-in-up">

                <!-- Step 1: Calendar -->
                <div class="calculator-step" id="step-1" data-step="1">
                    <div class="calculator-header">
                        <h2 class="calculator-header__title">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h2>
                        <p class="calculator-header__subtitle">–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞—Ç—ã –∏–º–µ—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∫–∏–¥–∫–∏</p>
                    </div>
                    <div class="calculator-body">
                        <div class="calendar-container" id="calendar-container">
                            <div class="calendar-header">
                                <button type="button" class="calendar-nav" id="calendar-prev">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M15 18l-6-6 6-6" />
                                    </svg>
                                </button>
                                <div class="calendar-title" id="calendar-title">–Ø–Ω–≤–∞—Ä—å 2026</div>
                                <button type="button" class="calendar-nav" id="calendar-next">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 18l6-6-6-6" />
                                    </svg>
                                </button>
                            </div>
                            <div class="calendar-weekdays">
                                <span>–ü–Ω</span><span>–í—Ç</span><span>–°—Ä</span><span>–ß—Ç</span><span>–ü—Ç</span><span>–°–±</span><span>–í—Å</span>
                            </div>
                            <div class="calendar-days" id="calendar-days">
                                <!-- Days will be generated by JS -->
                            </div>
                            <div class="calendar-legend">
                                <div class="calendar-legend__item">
                                    <span class="calendar-legend__dot calendar-legend__dot--discount"></span>
                                    <span>–°–∫–∏–¥–∫–∞</span>
                                </div>
                                <div class="calendar-legend__item">
                                    <span class="calendar-legend__dot calendar-legend__dot--selected"></span>
                                    <span>–í—ã–±—Ä–∞–Ω–æ</span>
                                </div>
                            </div>
                        </div>
                        <div class="selected-date-info" id="selected-date-info" style="display: none;">
                            <div class="selected-date-info__date" id="selected-date-display"></div>
                            <div class="selected-date-info__discount" id="selected-date-discount"></div>
                        </div>
                    </div>
                    <div class="calculator-footer">
                        <button type="button" class="btn btn--primary btn--lg btn--full" id="step1-next" disabled>
                            –î–∞–ª–µ–µ
                            <svg class="btn__icon" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Service Type -->
                <div class="calculator-step" id="step-2" data-step="2" style="display: none;">
                    <div class="calculator-header">
                        <h2 class="calculator-header__title">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</h2>
                        <p class="calculator-header__subtitle">–ö–ª–∏–Ω–∏–Ω–≥ –∏–ª–∏ —Ö–∏–º—á–∏—Å—Ç–∫–∞?</p>
                    </div>
                    <div class="calculator-body">
                        <div class="service-type-grid">
                            <label class="service-type-card">
                                <input type="radio" name="service_type" value="cleaning" checked>
                                <div class="service-type-card__content">
                                    <div class="service-type-card__icon">üè†</div>
                                    <div class="service-type-card__title">–£–±–æ—Ä–∫–∞</div>
                                    <div class="service-type-card__desc">–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è —É–±–æ—Ä–∫–∞ –ø–æ–º–µ—â–µ–Ω–∏–π
                                    </div>
                                </div>
                            </label>
                            <label class="service-type-card">
                                <input type="radio" name="service_type" value="drycleaning">
                                <div class="service-type-card__content">
                                    <div class="service-type-card__icon">üõãÔ∏è</div>
                                    <div class="service-type-card__title">–•–∏–º—á–∏—Å—Ç–∫–∞</div>
                                    <div class="service-type-card__desc">–•–∏–º—á–∏—Å—Ç–∫–∞ –º–µ–±–µ–ª–∏, –∫–æ–≤—Ä–æ–≤, –º–∞—Ç—Ä–∞—Å–æ–≤</div>
                                </div>
                            </label>
                        </div>
                    </div>
                    <div class="calculator-footer">
                        <button type="button" class="btn btn--outline btn--lg" id="step2-prev">
                            <svg class="btn__icon btn__icon--left" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" />
                            </svg>
                            –ù–∞–∑–∞–¥
                        </button>
                        <button type="button" class="btn btn--primary btn--lg" id="step2-next">
                            –î–∞–ª–µ–µ
                            <svg class="btn__icon" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Calculator Parameters -->
                <div class="calculator-step" id="step-3" data-step="3" style="display: none;">
                    <div class="calculator-header">
                        <h2 class="calculator-header__title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
                        <p class="calculator-header__subtitle">–£–∫–∞–∂–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞</p>
                    </div>
                    <div class="calculator-body">
                        <!-- Cleaning Parameters -->
                        <div id="cleaning-params">
                            <!-- Level Selection -->
                            <div class="form__group">
                                <label class="form__label">–¢–∏–ø —É–±–æ—Ä–∫–∏</label>
                                <div class="tabs tabs--premium" id="level-tabs">
                                    <button type="button" class="tab active" data-level="basic">BASIC</button>
                                    <button type="button" class="tab" data-level="general">GENERAL</button>
                                    <button type="button" class="tab" data-level="general_plus">GENERAL+</button>
                                </div>
                            </div>

                            <!-- Level Descriptions -->
                            <div class="level-descriptions" id="level-descriptions">
                                <div class="level-description active" data-level="basic">
                                    <h4 class="h5 mb-2">BASIC ‚Äî –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è —É–±–æ—Ä–∫–∞</h4>
                                    <p class="text-muted">–ë—ã—Å—Ç—Ä–∞—è —É–±–æ—Ä–∫–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —á–∏—Å—Ç–æ—Ç—ã</p>
                                </div>
                                <div class="level-description" data-level="general">
                                    <h4 class="h5 mb-2">GENERAL ‚Äî –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞</h4>
                                    <p class="text-muted">–ì–ª—É–±–æ–∫–∞—è —É–±–æ—Ä–∫–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π</p>
                                </div>
                                <div class="level-description" data-level="general_plus">
                                    <h4 class="h5 mb-2">GENERAL+ ‚Äî –ü—Ä–µ–º–∏—É–º —É–±–æ—Ä–∫–∞</h4>
                                    <p class="text-muted">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç—â–∞—Ç–µ–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞ —Å —Ö–∏–º—á–∏—Å—Ç–∫–æ–π</p>
                                </div>
                            </div>

                            <!-- Area Input -->
                            <div class="form__group">
                                <label class="form__label" for="area">–ü–ª–æ—â–∞–¥—å (–º¬≤)</label>
                                <div class="area-input-wrapper">
                                    <input type="number" id="area" class="form__input" min="20" max="500" value="50"
                                        step="1" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å">
                                    <span class="area-input-suffix">–º¬≤</span>
                                </div>
                                <div class="range-slider">
                                    <input type="range" id="area-slider" class="range-slider__input" min="20" max="200"
                                        value="50">
                                    <div class="range-slider__labels">
                                        <span>20 –º¬≤</span>
                                        <span>200 –º¬≤</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Extra Services -->
                            <div class="form__group">
                                <label class="form__label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</label>
                                <div class="extras-grid" id="extra-services">
                                    <div class="skeleton" style="height: 48px;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Drycleaning Parameters -->
                        <div id="drycleaning-params" style="display: none;">
                            <div class="form__group">
                                <label class="form__label">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç—ã —Ö–∏–º—á–∏—Å—Ç–∫–∏</label>
                                <div class="drycleaning-items" id="drycleaning-items">
                                    <div class="skeleton" style="height: 48px;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Price Display -->
                        <div class="price-display" id="price-display">
                            <div class="price-display__label">–ò—Ç–æ–≥–æ</div>
                            {% if promo_text %}
                            <div class="price-display__promo">{{ promo_text.text }}</div>
                            {% endif %}
                            <div class="price-display__old" id="old-price" style="display: none;"></div>
                            <div class="price-display__value" id="current-price">
                                <span class="spinner"></span>
                            </div>
                            <div class="price-display__discount" id="discount-info" style="display: none;"></div>
                            <div class="price-display__note">–¢–æ—á–Ω–∞—è —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ –æ—Å–º–æ—Ç—Ä–∞</div>
                        </div>
                    </div>
                    <div class="calculator-footer">
                        <button type="button" class="btn btn--outline btn--lg" id="step3-prev">
                            <svg class="btn__icon btn__icon--left" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" />
                            </svg>
                            –ù–∞–∑–∞–¥
                        </button>
                        <button type="button" class="btn btn--primary btn--lg" id="step3-next">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                            <svg class="btn__icon" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Step 4: Order Form -->
                <div class="calculator-step" id="step-4" data-step="4" style="display: none;">
                    <div class="calculator-header">
                        <h2 class="calculator-header__title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
                        <p class="calculator-header__subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</p>
                    </div>
                    <div class="calculator-body">
                        <!-- Order Summary -->
                        <div class="order-summary" id="order-summary">
                            <h4 class="order-summary__title">–í–∞—à –∑–∞–∫–∞–∑</h4>
                            <div class="order-summary__items" id="order-summary-items">
                                <!-- Filled by JS -->
                            </div>
                            <div class="order-summary__total">
                                <span>–ò—Ç–æ–≥–æ:</span>
                                <span id="order-summary-total">0 ‚ÇΩ</span>
                            </div>
                        </div>

                        <form class="form" id="order-form">
                            <div class="form__row">
                                <div class="form__group">
                                    <label class="form__label form__label--required" for="name">–ò–º—è</label>
                                    <input type="text" id="name" name="name" class="form__input" placeholder="–í–∞—à–µ –∏–º—è"
                                        required>
                                </div>
                                <div class="form__group">
                                    <label class="form__label form__label--required" for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                    <input type="tel" id="phone" name="phone" class="form__input" placeholder="+7 ..."
                                        required>
                                </div>
                            </div>

                            <div class="form__group">
                                <label class="form__label" for="address">–ê–¥—Ä–µ—Å</label>
                                <input type="text" id="address" name="address" class="form__input"
                                    placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞">
                            </div>

                            <div class="form__group">
                                <label class="form__label" for="time">–£–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è</label>
                                <select id="time" name="time" class="form__select">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</option>
                                    <option value="08:00">08:00 ‚Äî 10:00</option>
                                    <option value="10:00">10:00 ‚Äî 12:00</option>
                                    <option value="12:00">12:00 ‚Äî 14:00</option>
                                    <option value="14:00">14:00 ‚Äî 16:00</option>
                                    <option value="16:00">16:00 ‚Äî 18:00</option>
                                </select>
                            </div>

                            <div class="form__group">
                                <label class="form__label" for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                                <textarea id="comment" name="comment" class="form__textarea" rows="3"
                                    placeholder="–û—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è..."></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="calculator-footer calculator-footer--column">
                        <button type="button" class="btn btn--whatsapp btn--xl btn--full" id="submit-whatsapp">
                            <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                                <path
                                    d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z" />
                            </svg>
                            –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ WhatsApp
                        </button>
                        <button type="button" class="btn btn--outline btn--lg" id="step4-prev">
                            <svg class="btn__icon btn__icon--left" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" />
                            </svg>
                            –ù–∞–∑–∞–¥
                        </button>
                    </div>
                </div>

                <!-- Success Message -->
                <div class="order-success" id="order-success" style="display: none;">
                    <div class="success-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 11-5.93-9.14" />
                            <path d="M22 4L12 14.01l-3-3" />
                        </svg>
                    </div>
                    <h3 class="h3 mb-4">–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!</h3>
                    <p class="lead mb-6">–°–ø–∞—Å–∏–±–æ! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.</p>
                    <a href="{% url 'calculator:home' %}" class="btn btn--primary btn--lg">
                        –ù–∞ –≥–ª–∞–≤–Ω—É—é
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
    /* Page Hero for Calculator */
    .page-hero--calculator {
        background: var(--gradient-hero);
        padding: calc(var(--header-height) + var(--space-12)) 0 var(--space-12);
        text-align: center;
    }

    .page-hero__badge {
        display: inline-block;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        padding: var(--space-2) var(--space-4);
        border-radius: var(--radius-full);
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        margin-bottom: var(--space-4);
    }

    .page-hero__title {
        font-family: var(--font-heading);
        font-size: var(--text-5xl);
        font-weight: var(--font-extrabold);
        color: white;
        margin-bottom: var(--space-4);
    }

    .page-hero__subtitle {
        font-size: var(--text-lg);
        color: rgba(255, 255, 255, 0.9);
        max-width: 500px;
        margin: 0 auto;
    }

    /* Steps Indicator */
    .steps-indicator {
        display: flex;
        justify-content: center;
        gap: var(--space-8);
        margin-bottom: var(--space-8);
        padding: var(--space-6) 0;
    }

    @media (max-width: 640px) {
        .steps-indicator {
            gap: var(--space-4);
        }
    }

    .step-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--space-2);
        opacity: 0.5;
        transition: all var(--transition-base);
    }

    .step-item.active {
        opacity: 1;
    }

    .step-item.completed {
        opacity: 1;
    }

    .step-item__number {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--color-bg-alt);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: var(--font-semibold);
        color: var(--color-text-muted);
        transition: all var(--transition-base);
    }

    .step-item.active .step-item__number {
        background: var(--gradient-cta);
        color: white;
    }

    .step-item.completed .step-item__number {
        background: var(--color-accent);
        color: white;
    }

    .step-item__label {
        font-size: var(--text-sm);
        color: var(--color-text-muted);
    }

    .step-item.active .step-item__label {
        color: var(--color-text);
        font-weight: var(--font-medium);
    }

    /* Calculator Card */
    .calculator-wrapper {
        max-width: 700px;
        margin: 0 auto;
    }

    .calculator-card {
        background: var(--color-surface);
        border-radius: var(--radius-2xl);
        box-shadow: var(--shadow-xl);
        overflow: hidden;
    }

    .calculator-header {
        padding: var(--space-8);
        text-align: center;
        border-bottom: 1px solid var(--color-border-light);
    }

    .calculator-header__title {
        font-family: var(--font-heading);
        font-size: var(--text-2xl);
        font-weight: var(--font-bold);
        color: var(--color-text);
        margin-bottom: var(--space-2);
    }

    .calculator-header__subtitle {
        color: var(--color-text-muted);
    }

    .calculator-body {
        padding: var(--space-8);
    }

    .calculator-footer {
        display: flex;
        gap: var(--space-4);
        padding: var(--space-6) var(--space-8);
        border-top: 1px solid var(--color-border-light);
        background: var(--color-bg-alt);
    }

    .calculator-footer--column {
        flex-direction: column;
    }

    /* Calendar */
    .calendar-container {
        background: var(--color-bg-alt);
        border-radius: var(--radius-xl);
        padding: var(--space-6);
    }

    .calendar-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--space-4);
    }

    .calendar-nav {
        width: 36px;
        height: 36px;
        border-radius: var(--radius-full);
        border: 1px solid var(--color-border);
        background: var(--color-surface);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all var(--transition-fast);
    }

    .calendar-nav:hover {
        background: var(--color-primary-100);
        border-color: var(--color-primary);
    }

    .calendar-nav svg {
        width: 20px;
        height: 20px;
        color: var(--color-text-secondary);
    }

    .calendar-title {
        font-family: var(--font-heading);
        font-size: var(--text-lg);
        font-weight: var(--font-semibold);
    }

    .calendar-weekdays {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: var(--space-1);
        margin-bottom: var(--space-2);
    }

    .calendar-weekdays span {
        text-align: center;
        font-size: var(--text-xs);
        font-weight: var(--font-semibold);
        color: var(--color-text-muted);
        padding: var(--space-2);
    }

    .calendar-days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: var(--space-1);
    }

    .calendar-day {
        aspect-ratio: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all var(--transition-fast);
        position: relative;
        border: 2px solid transparent;
        background: var(--color-surface);
    }

    .calendar-day:hover:not(.disabled):not(.empty) {
        background: var(--color-primary-100);
        border-color: var(--color-primary-200);
    }

    .calendar-day.empty {
        background: transparent;
        cursor: default;
    }

    .calendar-day.disabled {
        opacity: 0.3;
        cursor: not-allowed;
    }

    .calendar-day.today {
        border-color: var(--color-primary);
    }

    .calendar-day.selected {
        background: var(--gradient-cta);
        color: white;
        border-color: transparent;
    }

    .calendar-day.has-discount {
        position: relative;
    }

    .calendar-day__discount {
        position: absolute;
        top: 2px;
        right: 2px;
        background: var(--gradient-orange);
        color: white;
        font-size: 9px;
        font-weight: var(--font-bold);
        padding: 2px 4px;
        border-radius: var(--radius-sm);
        line-height: 1;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        z-index: 2;
    }

    .calendar-day.selected .calendar-day__discount {
        background: rgba(255, 255, 255, 0.3);
        color: white;
    }

    .calendar-legend {
        display: flex;
        justify-content: center;
        gap: var(--space-6);
        margin-top: var(--space-4);
        padding-top: var(--space-4);
        border-top: 1px solid var(--color-border-light);
    }

    .calendar-legend__item {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        font-size: var(--text-xs);
        color: var(--color-text-muted);
    }

    .calendar-legend__dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }

    .calendar-legend__dot--discount {
        background: var(--gradient-orange);
    }

    .calendar-legend__dot--selected {
        background: linear-gradient(135deg, #14B8A6 0%, #2DD4BF 100%);
    }

    .selected-date-info {
        margin-top: var(--space-4);
        padding: var(--space-4);
        background: var(--color-primary-50);
        border-radius: var(--radius-lg);
        text-align: center;
    }

    .selected-date-info__date {
        font-weight: var(--font-semibold);
        color: var(--color-text);
        margin-bottom: var(--space-1);
    }

    .selected-date-info__discount {
        color: var(--color-accent);
        font-weight: var(--font-semibold);
    }

    /* Service Type Cards */
    .service-type-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: var(--space-4);
    }

    @media (max-width: 480px) {
        .service-type-grid {
            grid-template-columns: 1fr;
        }
    }

    .service-type-card {
        cursor: pointer;
    }

    .service-type-card input {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
    }

    .service-type-card__content {
        padding: var(--space-6);
        background: var(--color-bg-alt);
        border: 2px solid var(--color-border);
        border-radius: var(--radius-xl);
        text-align: center;
        transition: all var(--transition-base);
    }

    .service-type-card input:checked+.service-type-card__content {
        background: var(--color-primary-50);
        border-color: var(--color-primary);
    }

    .service-type-card:hover .service-type-card__content {
        border-color: var(--color-primary-200);
    }

    .service-type-card__icon {
        font-size: 48px;
        margin-bottom: var(--space-4);
    }

    .service-type-card__title {
        font-family: var(--font-heading);
        font-size: var(--text-xl);
        font-weight: var(--font-semibold);
        margin-bottom: var(--space-2);
    }

    .service-type-card__desc {
        font-size: var(--text-sm);
        color: var(--color-text-muted);
    }

    /* Area Input */
    .area-input-wrapper {
        position: relative;
    }

    .area-input-suffix {
        position: absolute;
        right: var(--space-4);
        top: 50%;
        transform: translateY(-50%);
        color: var(--color-text-muted);
        font-weight: var(--font-medium);
        pointer-events: none;
    }

    .area-input-wrapper .form__input {
        padding-right: var(--space-12);
    }

    /* Extras Grid */
    .extras-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: var(--space-3);
    }

    @media (max-width: 640px) {
        .extras-grid {
            grid-template-columns: 1fr;
        }
    }

    .extra-service-item {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        padding: var(--space-4);
        background: var(--color-bg-alt);
        border: 2px solid transparent;
        border-radius: var(--radius-lg);
        cursor: pointer;
        transition: all var(--transition-fast);
    }

    .extra-service-item:hover {
        background: var(--color-surface);
        border-color: var(--color-primary-200);
    }

    .extra-service-item.selected {
        background: var(--color-primary-50);
        border-color: var(--color-primary);
    }

    .extra-service-item__checkbox {
        width: 20px;
        height: 20px;
        border-radius: var(--radius-sm);
        border: 2px solid var(--color-border);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all var(--transition-fast);
        flex-shrink: 0;
    }

    .extra-service-item.selected .extra-service-item__checkbox {
        background: var(--gradient-cta);
        border-color: transparent;
    }

    .extra-service-item__checkbox svg {
        width: 12px;
        height: 12px;
        color: white;
        opacity: 0;
        transition: opacity var(--transition-fast);
    }

    .extra-service-item.selected .extra-service-item__checkbox svg {
        opacity: 1;
    }

    .extra-service-item__info {
        flex: 1;
    }

    .extra-service-item__name {
        font-weight: var(--font-medium);
        color: var(--color-text);
        margin-bottom: var(--space-1);
    }

    .extra-service-item__price {
        font-size: var(--text-sm);
        color: var(--color-text-muted);
    }

    /* Level Descriptions */
    .level-descriptions {
        margin-bottom: var(--space-6);
    }

    .level-description {
        display: none;
        padding: var(--space-4);
        background: var(--color-bg-alt);
        border-radius: var(--radius-lg);
    }

    .level-description.active {
        display: block;
    }

    /* Drycleaning Items */
    .drycleaning-items {
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
    }

    .drycleaning-item-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: var(--space-4);
        padding: var(--space-4);
        background: var(--color-bg-alt);
        border-radius: var(--radius-lg);
    }

    .drycleaning-item-row__info {
        flex: 1;
    }

    .drycleaning-item-row__name {
        font-weight: var(--font-medium);
    }

    .drycleaning-item-row__price {
        font-size: var(--text-sm);
        color: var(--color-text-muted);
    }

    .drycleaning-item-row__quantity {
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }

    .drycleaning-item-row__quantity input {
        width: 60px;
        text-align: center;
    }

    /* Order Summary */
    .order-summary {
        background: var(--color-bg-alt);
        border-radius: var(--radius-xl);
        padding: var(--space-6);
        margin-bottom: var(--space-6);
    }

    .order-summary__title {
        font-family: var(--font-heading);
        font-weight: var(--font-semibold);
        margin-bottom: var(--space-4);
    }

    .order-summary__items {
        display: flex;
        flex-direction: column;
        gap: var(--space-2);
        margin-bottom: var(--space-4);
        padding-bottom: var(--space-4);
        border-bottom: 1px solid var(--color-border);
    }

    .order-summary__item {
        display: flex;
        justify-content: space-between;
        font-size: var(--text-sm);
        color: var(--color-text-secondary);
    }

    .order-summary__total {
        display: flex;
        justify-content: space-between;
        font-size: var(--text-xl);
        font-weight: var(--font-bold);
        color: var(--color-primary);
    }

    /* Form Row */
    .form__row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-4);
    }

    @media (max-width: 640px) {
        .form__row {
            grid-template-columns: 1fr;
        }
    }

    /* WhatsApp Button */
    .btn--whatsapp {
        background: #25D366;
        color: white;
        border: none;
    }

    .btn--whatsapp:hover {
        background: #20bd5a;
    }

    /* Order Success */
    .order-success {
        text-align: center;
        padding: var(--space-10);
    }

    .success-icon {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: var(--color-success-light);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto var(--space-6);
        animation: scaleIn 0.5s ease-out;
    }

    .success-icon svg {
        width: 40px;
        height: 40px;
        color: var(--color-success);
    }

    /* Price Display */
    .price-display {
        margin-top: var(--space-6);
        padding: var(--space-6);
        background: var(--gradient-card);
        border-radius: var(--radius-xl);
        text-align: center;
        border: 1px solid var(--color-border-light);
    }

    .price-display__label {
        font-size: var(--text-sm);
        color: var(--color-text-muted);
        margin-bottom: var(--space-2);
    }

    .price-display__promo {
        display: inline-block;
        background: var(--color-accent);
        color: white;
        padding: var(--space-1) var(--space-3);
        border-radius: var(--radius-full);
        font-size: var(--text-xs);
        font-weight: var(--font-semibold);
        margin-bottom: var(--space-2);
    }

    .price-display__old {
        font-size: var(--text-lg);
        color: var(--color-text-muted);
        text-decoration: line-through;
        margin-bottom: var(--space-1);
    }

    .price-display__value {
        font-family: var(--font-heading);
        font-size: var(--text-4xl);
        font-weight: var(--font-bold);
        color: var(--color-primary);
    }

    .price-display__discount {
        font-size: var(--text-sm);
        color: var(--color-accent);
        font-weight: var(--font-semibold);
        margin-top: var(--space-2);
    }

    .price-display__note {
        font-size: var(--text-xs);
        color: var(--color-text-muted);
        margin-top: var(--space-2);
    }

    /* Spinner */
    .spinner {
        display: inline-block;
        width: 24px;
        height: 24px;
        border: 3px solid var(--color-border);
        border-top-color: var(--color-primary);
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
        to {
            transform: rotate(360deg);
        }
    }

    @keyframes scaleIn {
        from {
            opacity: 0;
            transform: scale(0.5);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    /* Utilities */
    .h5 {
        font-family: var(--font-heading);
        font-size: var(--text-lg);
        font-weight: var(--font-semibold);
    }

    .mb-2 {
        margin-bottom: var(--space-2);
    }

    .mb-4 {
        margin-bottom: var(--space-4);
    }

    .mb-6 {
        margin-bottom: var(--space-6);
    }

    .text-muted {
        color: var(--color-text-muted);
    }

    .btn__icon--left {
        margin-right: var(--space-2);
        margin-left: 0;
    }
</style>
{% endblock %}

{% block extra_js %}
<script src="{% static 'calculator/js/calculator.js' %}"></script>
<script>
    // Initialize calculator with WhatsApp number from context
    window.WHATSAPP_NUMBER = "{{ company_info.whatsapp|default:'' }}";
</script>
{% endblock %}